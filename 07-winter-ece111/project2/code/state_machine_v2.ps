%!PS-Adobe-2.0
%%Creator: dot version 2.8 (Sat Feb 17 15:51:01 UTC 2007)
%%For: (nitay) 
%%Title: state_machine
%%Pages: (atend)
%%BoundingBox: 36 36 1137 988
%%EndComments
save
%%BeginProlog
/DotDict 200 dict def
DotDict begin

/setupLatin1 {
mark
/EncodingVector 256 array def
 EncodingVector 0

ISOLatin1Encoding 0 255 getinterval putinterval
EncodingVector 45 /hyphen put

% Set up ISO Latin 1 character encoding
/starnetISO {
        dup dup findfont dup length dict begin
        { 1 index /FID ne { def }{ pop pop } ifelse
        } forall
        /Encoding EncodingVector def
        currentdict end definefont
} def
/Times-Roman starnetISO def
/Times-Italic starnetISO def
/Times-Bold starnetISO def
/Times-BoldItalic starnetISO def
/Helvetica starnetISO def
/Helvetica-Oblique starnetISO def
/Helvetica-Bold starnetISO def
/Helvetica-BoldOblique starnetISO def
/Courier starnetISO def
/Courier-Oblique starnetISO def
/Courier-Bold starnetISO def
/Courier-BoldOblique starnetISO def
cleartomark
} bind def

%%BeginResource: procset graphviz 0 0
/coord-font-family /Times-Roman def
/default-font-family /Times-Roman def
/coordfont coord-font-family findfont 8 scalefont def

/InvScaleFactor 1.0 def
/set_scale {
	dup 1 exch div /InvScaleFactor exch def
	dup scale
} bind def

% styles
/solid { [] 0 setdash } bind def
/dashed { [9 InvScaleFactor mul dup ] 0 setdash } bind def
/dotted { [1 InvScaleFactor mul 6 InvScaleFactor mul] 0 setdash } bind def
/invis {/fill {newpath} def /stroke {newpath} def /show {pop newpath} def} bind def
/bold { 2 setlinewidth } bind def
/filled { } bind def
/unfilled { } bind def
/rounded { } bind def
/diagonals { } bind def

% hooks for setting color 
/nodecolor { sethsbcolor } bind def
/edgecolor { sethsbcolor } bind def
/graphcolor { sethsbcolor } bind def
/nopcolor {pop pop pop} bind def

/beginpage {	% i j npages
	/npages exch def
	/j exch def
	/i exch def
	/str 10 string def
	npages 1 gt {
		gsave
			coordfont setfont
			0 0 moveto
			(\() show i str cvs show (,) show j str cvs show (\)) show
		grestore
	} if
} bind def

/set_font {
	findfont exch
	scalefont setfont
} def

% draw aligned label in bounding box aligned to current point
/alignedtext {			% width adj text
	/text exch def
	/adj exch def
	/width exch def
	gsave
		width 0 gt {
			text stringwidth pop adj mul 0 rmoveto
		} if
		[] 0 setdash
		text show
	grestore
} def

/boxprim {				% xcorner ycorner xsize ysize
		4 2 roll
		moveto
		2 copy
		exch 0 rlineto
		0 exch rlineto
		pop neg 0 rlineto
		closepath
} bind def

/ellipse_path {
	/ry exch def
	/rx exch def
	/y exch def
	/x exch def
	matrix currentmatrix
	newpath
	x y translate
	rx ry scale
	0 0 1 0 360 arc
	setmatrix
} bind def

/endpage { showpage } bind def
/showpage { } def

/layercolorseq
	[	% layer color sequence - darkest to lightest
		[0 0 0]
		[.2 .8 .8]
		[.4 .8 .8]
		[.6 .8 .8]
		[.8 .8 .8]
	]
def

/layerlen layercolorseq length def

/setlayer {/maxlayer exch def /curlayer exch def
	layercolorseq curlayer 1 sub layerlen mod get
	aload pop sethsbcolor
	/nodecolor {nopcolor} def
	/edgecolor {nopcolor} def
	/graphcolor {nopcolor} def
} bind def

/onlayer { curlayer ne {invis} if } def

/onlayers {
	/myupper exch def
	/mylower exch def
	curlayer mylower lt
	curlayer myupper gt
	or
	{invis} if
} def

/curlayer 0 def

%%EndResource
%%EndProlog
%%BeginSetup
14 default-font-family set_font
1 setmiterlimit
% /arrowlength 10 def
% /arrowwidth 5 def

% make sure pdfmark is harmless for PS-interpreters other than Distiller
/pdfmark where {pop} {userdict /pdfmark /cleartomark load put} ifelse
% make '<<' and '>>' safe on PS Level 1 devices
/languagelevel where {pop languagelevel}{1} ifelse
2 lt {
    userdict (<<) cvn ([) cvn load put
    userdict (>>) cvn ([) cvn load put
} if

%%EndSetup
%%Page: 1 1
%%PageBoundingBox: 36 36 1137 988
%%PageOrientation: Portrait
<< /PageSize [1101 952] >> setpagedevice
gsave
36 36 1101 952 boxprim clip newpath
36 36 translate
0 0 1 beginpage
1.0000 set_scale
4 4 translate 0 rotate
[ /CropBox [36 36 1137 988] /PAGE pdfmark
0.000 0.000 1.000 graphcolor
0.000 0.000 1.000 graphcolor
newpath -6 -6 moveto
-6 950 lineto
1099 950 lineto
1099 -6 lineto
closepath
fill
0.000 0.000 1.000 graphcolor
newpath -6 -6 moveto
-6 950 lineto
1099 950 lineto
1099 -6 lineto
closepath
stroke
0.000 0.000 0.000 graphcolor
14.00 /Times-Roman set_font
% start
gsave 10 dict begin
387 848 170 96 ellipse_path
stroke
gsave 10 dict begin
365 899 moveto
(START)
[7.44 7.92 10.08 8.88 8.64]
xshow
363 883 moveto
( done=0)
[3.6 6.96 6.96 6.96 6.24 7.92 6.96]
xshow
361 867 moveto
( count=0)
[3.6 6.24 6.96 6.96 6.96 3.84 7.92 6.96]
xshow
375 851 moveto
( i=0)
[3.6 3.84 7.92 6.96]
xshow
340 835 moveto
( j=seed_lsw[7:0])
[3.6 3.84 7.92 5.52 6.24 6.24 6.96 6.96 3.84 5.52 10.08 4.56 6 3.84 6.96 4.56]
xshow
312 819 moveto
( for k=0 to 255: sbox[k]=k)
[3.6 4.08 6.96 4.56 3.6 6.96 7.92 6.96 3.6 3.84 6.96 3.6 6.96 6.96 6.96 3.84 3.6 5.52 6.96 6.48 6.96 4.56 6.96 4.56 7.92 6.96]
xshow
263 803 moveto
( for k=0 to 3: seed[k]=seed_lsw[8*k+7:8*k])
[3.6 4.08 6.96 4.56 3.6 6.96 7.92 6.96 3.6 3.84 6.96 3.6 6.96 3.84 3.6 5.52 6.24 6.24 6.96 4.56 6.96 4.56 7.92 5.52 6.24 6.24 6.96 6.96 3.84 5.52 10.08 4.56 6.96 6.96 6.96 7.92 6 3.84 6.96 6.96 6.96 4.56]
xshow
252 787 moveto
( for k=0 to 3: seed[k+4]=seed_msw[8*k+7:8*k])
[3.6 4.08 6.96 4.56 3.6 6.96 7.92 6.96 3.6 3.84 6.96 3.6 6.96 3.84 3.6 5.52 6.24 6.24 6.96 4.56 6.96 7.92 6.96 4.56 7.92 5.52 6.24 6.24 6.96 6.96 10.8 5.52 10.08 4.56 6.96 6.96 6.96 7.92 6 3.84 6.96 6.96 6.96 4.56]
xshow
end grestore
end grestore
% construct_sbox
gsave 10 dict begin
395 638 132 62 ellipse_path
stroke
gsave 10 dict begin
332 665 moveto
(CONSTRUCT_SBOX)
[9.12 10.08 10.08 7.44 8.64 8.64 10.08 9.36 8.64 6.96 7.68 9.12 9.36 10.08]
xshow
349 649 moveto
( sbox[i]=sbox[j])
[3.6 5.52 6.96 6.48 6.96 4.56 3.84 4.56 7.92 5.52 6.96 6.48 6.96 4.56 3.84 4.56]
xshow
349 633 moveto
( sbox[j]=sbox[i])
[3.6 5.52 6.96 6.48 6.96 4.56 3.84 4.56 7.92 5.52 6.96 6.48 6.96 4.56 3.84 4.56]
xshow
382 617 moveto
( i++)
[3.6 3.84 7.92 7.92]
xshow
288 601 moveto
( j=\(j+sbox[i+1]+seed[\(i+1\)%8]\)%256)
[3.6 3.84 7.92 4.56 3.84 7.92 5.52 6.96 6.48 6.96 4.56 3.84 7.92 6.96 4.56 7.92 5.52 6.24 6.24 6.96 4.56 4.56 3.84 7.92 6.96 4.56 11.76 6.96 4.56 4.56 11.76 6.96 6.96 6.96]
xshow
end grestore
end grestore
% start->construct_sbox
newpath 330 757 moveto
327 744 327 731 332 718 curveto
334 713 336 709 338 704 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 341 705 moveto
343 695 lineto
335 702 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 341 705 moveto
343 695 lineto
335 702 lineto
closepath
stroke
end grestore
gsave 10 dict begin
331 721 moveto
(start_encrypt=1)
[5.28 4.08 6.24 4.8 3.84 6.96 6.24 6.96 6.24 4.8 6.96 6.96 3.84 7.92 6.96]
xshow
end grestore
% construct_sbox->start
newpath 417 700 moveto
419 706 420 712 421 718 curveto
422 727 423 735 422 744 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 419 744 moveto
421 754 lineto
425 744 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 419 744 moveto
421 754 lineto
425 744 lineto
closepath
stroke
end grestore
gsave 10 dict begin
420 721 moveto
(nreset=0)
[6.96 4.56 6.24 5.52 6 3.84 7.92 6.96]
xshow
end grestore
% read_word
gsave 10 dict begin
196 450 121 73 ellipse_path
stroke
gsave 10 dict begin
152 485 moveto
(READ_WORD)
[9.36 8.64 10.08 10.08 6.96 12.48 10.08 9.36 10.08]
xshow
184 469 moveto
( i=1)
[3.6 3.84 7.92 6.96]
xshow
150 453 moveto
( j=sbox[1]%256)
[3.6 3.84 7.92 5.52 6.96 6.48 6.96 4.56 6.96 4.56 11.76 6.96 6.96 6.96]
xshow
155 437 moveto
( byte_count=0)
[3.6 6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 7.92 6.96]
xshow
154 421 moveto
( port_A_we=0)
[3.6 6.96 6.96 4.8 3.84 6.96 10.08 6.96 9.6 6.24 7.92 6.96]
xshow
104 405 moveto
( port_A_addr=plain_addr+count)
[3.6 6.96 6.96 4.8 3.84 6.96 10.08 6.96 6.24 6.96 6.96 4.56 7.92 6.96 3.84 6.24 3.84 6.96 6.96 6.24 6.96 6.96 4.56 7.92 6.24 6.96 6.96 6.96 3.84]
xshow
end grestore
end grestore
% construct_sbox->read_word
newpath 336 582 moveto
314 562 290 540 269 519 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 272 517 moveto
262 512 lineto
267 522 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 272 517 moveto
262 512 lineto
267 522 lineto
closepath
stroke
end grestore
gsave 10 dict begin
306 545 moveto
(i=255)
[3.84 7.92 6.96 6.96 6.96]
xshow
end grestore
% read_word->start
newpath 183 523 moveto
178 575 178 645 205 700 curveto
219 727 239 751 262 771 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 260 774 moveto
270 778 lineto
265 769 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 260 774 moveto
270 778 lineto
265 769 lineto
closepath
stroke
end grestore
gsave 10 dict begin
205 633 moveto
(nreset=0)
[6.96 4.56 6.24 5.52 6 3.84 7.92 6.96]
xshow
end grestore
% done
gsave 10 dict begin
40 239 39 28 ellipse_path
stroke
gsave 10 dict begin
19 242 moveto
(DONE)
[10.08 10.08 10.08 8.64]
xshow
16 226 moveto
( done=1)
[3.6 6.96 6.96 6.96 6.24 7.92 6.96]
xshow
end grestore
end grestore
% read_word->done
newpath 102 403 moveto
85 391 68 376 57 358 curveto
42 334 38 303 38 278 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 42 278 moveto
38 268 lineto
35 278 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 42 278 moveto
38 268 lineto
35 278 lineto
closepath
stroke
end grestore
gsave 10 dict begin
57 345 moveto
(count>=frame_size)
[6.24 6.96 6.96 6.96 3.84 7.92 7.92 4.56 4.56 6.24 10.8 6.24 6.96 5.52 3.84 6.24 6.24]
xshow
end grestore
% encrypt_byte
gsave 10 dict begin
603 239 394 84 ellipse_path
stroke
gsave 10 dict begin
550 282 moveto
(ENCRYPT_BYTE)
[8.64 9.84 9.36 8.4 10.08 7.68 8.64 6.96 8.4 10.32 8.64 8.64]
xshow
241 266 moveto
( port_A_data_in[byte_count*8+7:byte_count*8]=sbox[\(sbox[i]+sbox[j]\)%256]   ^port_A_data_in[byte_count*8+7:byte_count*8])
[3.6 6.96 6.96 4.8 3.84 6.96 10.08 6.96 6.96 6.24 4.08 6.24 6.96 3.84 6.96 4.56 6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 6.96 6.96 7.92 6 3.84 6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 6.96 6.96 4.56 7.92 5.52 6.96 6.48 6.96 4.56 4.56 5.52 6.96 6.48 6.96 4.56 3.84 4.56 7.92 5.52 6.96 6.48 6.96 4.56 3.84 4.56 4.56 11.76 6.96 6.96 6.96 4.56 3.6 3.6 3.6 6.48 6.96 6.96 4.8 3.84 6.96 10.08 6.96 6.96 6.24 4.08 6.24 6.96 3.84 6.96 4.56 6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 6.96 6.96 7.92 6 3.84 6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 6.96 6.96 4.56]
xshow
557 250 moveto
( sbox[i]=sbox[j])
[3.6 5.52 6.96 6.48 6.96 4.56 3.84 4.56 7.92 5.52 6.96 6.48 6.96 4.56 3.84 4.56]
xshow
557 234 moveto
( sbox[j]=sbox[i])
[3.6 5.52 6.96 6.48 6.96 4.56 3.84 4.56 7.92 5.52 6.96 6.48 6.96 4.56 3.84 4.56]
xshow
564 218 moveto
( i=\(i+1\)%256)
[3.6 3.84 7.92 4.56 3.84 7.92 6.96 4.56 11.76 6.96 6.96 6.96]
xshow
520 202 moveto
( j=\(j+sbox[\(i+1\)%256]\)%256)
[3.6 3.84 7.92 4.56 3.84 7.92 5.52 6.96 6.48 6.96 4.56 4.56 3.84 7.92 6.96 4.56 11.76 6.96 6.96 6.96 4.56 4.56 11.76 6.96 6.96 6.96]
xshow
561 186 moveto
( byte_count++)
[3.6 6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 7.92 7.92]
xshow
end grestore
end grestore
% read_word->encrypt_byte
newpath 288 402 moveto
333 378 389 349 442 323 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 444 326 moveto
451 318 lineto
441 320 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 444 326 moveto
451 318 lineto
441 320 lineto
closepath
stroke
end grestore
% done->start
newpath 38 267 moveto
36 320 35 434 66 524 curveto
105 631 125 663 215 734 curveto
231 746 248 759 266 770 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 264 773 moveto
274 776 lineto
268 767 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 264 773 moveto
274 776 lineto
268 767 lineto
closepath
stroke
end grestore
% encrypt_byte->start
newpath 606 324 moveto
607 420 597 579 536 700 curveto
525 722 509 743 492 761 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 489 759 moveto
485 769 lineto
494 764 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 489 759 moveto
485 769 lineto
494 764 lineto
closepath
stroke
end grestore
gsave 10 dict begin
583 545 moveto
(nreset=0)
[6.96 4.56 6.24 5.52 6 3.84 7.92 6.96]
xshow
end grestore
% encrypt_byte->encrypt_byte
newpath 971 270 moveto
999 263 1016 253 1016 239 curveto
1016 227 1003 217 981 211 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 982 208 moveto
971 208 lineto
980 214 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 982 208 moveto
971 208 lineto
980 214 lineto
closepath
stroke
end grestore
% write_word
gsave 10 dict begin
603 51 117 50 ellipse_path
stroke
gsave 10 dict begin
555 70 moveto
(WRITE_WORD)
[13.2 9.36 4.56 8.64 8.64 6.96 12.48 10.08 9.36 10.08]
xshow
561 54 moveto
( port_A_we=1)
[3.6 6.96 6.96 4.8 3.84 6.96 10.08 6.96 9.6 6.24 7.92 6.96]
xshow
508 38 moveto
( port_A_addr=cipher_addr+count)
[3.6 6.96 6.96 4.8 3.84 6.96 10.08 6.96 6.24 6.96 6.96 4.56 7.92 6.24 3.84 6.96 6.96 6.24 4.56 6.96 6.24 6.96 6.96 4.56 7.92 6.24 6.96 6.96 6.96 3.84]
xshow
573 22 moveto
( count+=4)
[3.6 6.24 6.96 6.96 6.96 3.84 7.92 7.92 6.96]
xshow
end grestore
end grestore
% encrypt_byte->write_word
newpath 499 157 moveto
494 145 493 133 500 120 curveto
504 111 510 103 517 97 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 520 99 moveto
525 90 lineto
515 94 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 520 99 moveto
525 90 lineto
515 94 lineto
closepath
stroke
end grestore
gsave 10 dict begin
499 123 moveto
(count+byte_count+1=frame_size)
[6.24 6.96 6.96 6.96 3.84 7.92 6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 7.92 6.96 7.92 4.56 4.56 6.24 10.8 6.24 6.96 5.52 3.84 6.24 6.24]
xshow
end grestore
% encrypt_byte->write_word
newpath 676 155 moveto
680 149 683 143 685 136 curveto
690 123 686 111 679 101 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 681 98 moveto
672 93 lineto
676 103 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 681 98 moveto
672 93 lineto
676 103 lineto
closepath
stroke
end grestore
gsave 10 dict begin
686 123 moveto
(byte_count=3)
[6.48 6.96 3.84 6.24 6.96 6.24 6.96 6.96 6.96 3.84 7.92 6.96]
xshow
end grestore
% write_word->start
newpath 717 65 moveto
826 81 982 111 1025 154 curveto
1052 181 1044 200 1044 239 curveto
1044 638 1044 638 1044 638 curveto
1044 739 758 798 564 827 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 564 824 moveto
554 828 lineto
564 830 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 564 824 moveto
554 828 lineto
564 830 lineto
closepath
stroke
end grestore
gsave 10 dict begin
1043 445 moveto
(nreset=0)
[6.96 4.56 6.24 5.52 6 3.84 7.92 6.96]
xshow
end grestore
% write_word->read_word
newpath 489 65 moveto
383 80 235 109 199 154 curveto
152 213 158 303 172 368 curveto
stroke
gsave 10 dict begin
solid
1 setlinewidth
0.000 0.000 0.000 edgecolor
newpath 169 369 moveto
174 378 lineto
175 368 lineto
closepath
fill
0.000 0.000 0.000 edgecolor
newpath 169 369 moveto
174 378 lineto
175 368 lineto
closepath
stroke
end grestore
endpage
showpage
grestore
%%PageTrailer
%%EndPage: 1
%%Trailer
%%Pages: 1
end
restore
%%EOF
